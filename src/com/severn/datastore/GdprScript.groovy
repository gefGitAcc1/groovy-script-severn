import com.google.appengine.api.datastore.DatastoreServiceFactory
import com.google.appengine.api.datastore.Entity
import com.google.appengine.api.datastore.Query
import com.google.appengine.api.datastore.Query.Filter
import com.google.appengine.api.datastore.Query.FilterOperator
import com.google.appengine.api.datastore.Query.FilterPredicate
import com.google.appengine.api.memcache.MemcacheServiceFactory
import com.severn.datastore.legacy.DatastoreUtil

//Filter f = new FilterPredicate('segmentableGiftId', FilterOperator.EQUAL, 9642)
//Query q = new Query('Gift_marketingCompensation').setFilter(f)

//def users = [6050767374909440,5432872911503360,5432872911503360,6228747866865664,6228747866865664,6615050110369792,4818332213575680,6644969120989184,6644969120989184,6012728795725824,6012728795725824,6181770252779520,5736773237866496,5104872064024576,5104872064024576,5535456964378624,5535456964378624,4610106294009856,5099659618418688,5099659618418688,6103500916785152,6428247722557440,5106853839634432,5204740439277568,5204740439277568,5425076875296768,5425076875296768,6290998250962944,6290998250962944,5473442669789184,4946059390877696,4946059390877696,4560573191159808,4560573191159808,4803427889053696,4803427889053696,4709342452908032,5163887448555520,5374452531986432,5374452531986432,5715039210700800,5715039210700800,4955070601363456,6130023363248128,5153639908245504,5444297608921088,5444297608921088,4556137060368384,6353555120717824,6353555120717824,6247357792911360,6247357792911360,5557809417027584,5557809417027584,6633282112847872,6633282112847872,4719745350238208,5867339254333440,5867339254333440,6275820759285760,6275820759285760,4693164116410368,6272672783138816,6272672783138816,5972484717805568,5972484717805568,5251016195309568,5251016195309568,5381183785926656,5381183785926656,4736878629093376,4736878629093376,6624280566038528,6624280566038528,4513368682004480,6734764506087424,6734764506087424,5936862712037376,6421382317998080,6421382317998080,5858780256927744,5858780256927744,6658700819824640,6658700819824640,5041306447904768,5041306447904768,5328154445479936,4625841410015232,4625841410015232,5629974699048960,6668553692905472,5629094314639360,5629094314639360,6335071192088576,6335071192088576,4759621454004224,5932933538381824,5932933538381824,4676561198907392,5726947024306176,5726947024306176,5099628479905792,5099628479905792,5288332163022848,5288332163022848,6000931930374144,4657582258520064,6174938386399232,5292726367551488,5292726367551488,6532537447350272,6532537447350272,4626499680862208,4626499680862208,5989773856997376,5989773856997376,5860869053874176,5860869053874176,4855142566854656,5691111008894976,5691111008894976,6343199703433216,5822998952017920,5822998952017920,5694326479781888,5083998826004480,5100053950627840,5100053950627840,6313399592943616,6313399592943616,4925708645171200,6378082539143168,4741103250571264,4741103250571264,5948195235954688,6088670882299904,4635061145567232,6283400874295296,6283400874295296,5852680129347584,5771415069917184,6438479392669696,6158804242137088,6547387398488064,5931789752729600,5931789752729600,5173517605142528,5173517605142528,5672850519752704,6520612656250880,5553179862761472,6578886822854656,4976305726029824,5711982117781504,5675346499731456,4511681130004480,5311481651920896,5202475432280064,4930518119874560,4897562970030080,6209177447301120,6595333930352640,5323628473745408,5810570407706624,5684706609201152,6024958246912000,4809448427618304,4809448427618304,5319815180320768,5486203908390912,5189993788080128,5189993788080128,6311706890338304,6210556300099584,6210556300099584,6210556300099584,4745157298094080,4745157298094080,5162525291708416,5162525291708416,5306754655584256,5306754655584256,5117618606833664,5117618606833664,6204078013546496,6204078013546496,5873009099800576,5873009099800576,4804722773458944,4804722773458944,6091052761481216,6091052761481216,5663110860374016,5663110860374016,5628399219900416,5628399219900416,6030031007514624,6030031007514624,6604899646177280,6045085220208640,6045085220208640,5830508721209344,5062074647445504,5062074647445504,5030335375998976,6277675583799296,6277675583799296,5129390441627648,5129390441627648,4668407340335104,4876180963459072,4916480775815168,6160367846686720,6251408352346112,5014642555355136,5014642555355136,5028717230292992,5028717230292992,4809222926630912,4809222926630912,6439274785275904,4533851199111168,4533851199111168,4928610300329984,4928610300329984,4815519701008384,4815519701008384,6010852116267008,4746628509466624,4746628509466624,5432453215813632,5432453215813632,6539919173353472,6539919173353472,5635665399119872,6494139452489728,5530709618851840,5530709618851840,6285631926829056,6285631926829056,5988162793897984,5733393990942720,5740863123619840,5740863123619840,5850161652695040,5850161652695040,5334220384763904,4877764262887424,6511428139220992,4645625626361856,5823941314084864,6281050522648576,4551935411093504,4551935411093504,6112511794872320,5091761294147584,5039560328740864,4817257150021632,5609760254066688,5321967481126912,6590116721590272,4901730969452544,5629276971335680,5128990674649088,5748080145596416,5528177820041216,5897656676646912,5148146295898112,5057144528830464,4748903433371648,4948396124667904,4508875042062336,5334685885923328,5550821609046016,6183959968350208,4667969656848384,5715881547530240,6354659215671296,5413107928662016,5413107928662016,4521356804227072,6481021649813504,5619133416210432,5619133416210432,5321586705432576,5848411823144960,6166501396054016,5031457520615424,6357919515279360,5740015455305728,5735930958184448,6594172831662080,6594172831662080,5517793897742336,5721761894629376,5711806261100544,5325078849388544,6484264752775168,4855145002696704,6746098978258944,4968996163551232,4587959549952000,5296203952029696,6017603889266688,6453676264128512,6548410441662464,6386932606566400,4890587509030912,5682545185783808,5008686409318400,6610872419483648,6477603963142144,5471241636413440,4655550037491712,6749445378539520,6584690449842176,5025200827006976,5373904943579136,4897490024792064,5358421620031488,4664745747021824,6193350377472000,5990198525034496,6454570389078016,6690548877885440,6201111584702464,4637756390637568,6322448722558976,5624404867809280,6639288459984896,5512598279159808,4540054524919808,6143451799748608,6475590227460096,4516754545442816,6207571517505536,6207571517505536,6453200730718208,5619015136837632,5071694586183680,5291773055729664,6668546431516672,4552398999126016,4978528474365952,5961999800336384,6662912710017024,6662912710017024,5079991037460480,5079991037460480,6598370810396672,6598370810396672,5782959156625408,5024687076147200,6437430735929344,6180235377115136,6180235377115136,5478099911704576,5478099911704576,6339988900282368,6339988900282368,5694086082723840,5475876578263040,5475876578263040,5176448655032320,5176448655032320,6625974465069056,6705358463041536,6705358463041536,4603509060665344,5057293914210304,5057293914210304,5150641405034496,5150641405034496,4997628967256064,5402344071102464,5402344071102464,5155675861680128,5264626448072704,5149676161466368,5459279080325120,5459279080325120,5751216681254912,5751216681254912,4807840452575232,5759631126167552,5204382116216832,5204382116216832,5185368950308864,5185368950308864,6197259101274112,6545199166652416,4876359827456000,5846365373988864,6141580068519936,4999818864230400,6155775354863616,5543300385210368,6516398425112576,4995494721355776,6334021329485824,4872306570035200,6595524792156160,4702333306404864,6396483944841216,6209236423409664,5271228719300608,5045674485219328,4629591055925248,6221769792290816,5390681155043328,5303355997421568,6120589909032960,5589779195887616,4628780330516480,5638205774757888,5638205774757888,5029235699744768,5029235699744768,5959289795510272,4675716069195776,4675716069195776,5001936183492608,6634380322144256,4994029350027264,6484524735660032,4755517048619008,6196358350897152,6397040731357184,4623541444542464,5063698333302784,5047656714338304,6640952175755264,6715641824804864,5938935828578304,5938935828578304,5991983087091712,6023486772871168,4545189094359040,4706138732363776,4894722206728192,6531456950599680,6169610267656192,5698216148860928,5645139010125824,6708581502550016,6440077343850496,5312888963596288,6563682257993728,6563682257993728,6277671846150144,5820502793256960,5337284629495808,5415229729538048,5175093829828608,5154392272011264,4847912079589376,5709873461854208,6361188089200640,6361188089200640,5355061952118784,4620626856247296,5140657302142976,4999773801676800,4877358778023936,5432333010731008,5527092874182656,5384701924081664,5774324328300544,6736908254707712,6644527819915264,6173344171294720,5447653645615104,5101810010816512,5078080501055488,5833771473960960,5833771473960960,6042704503373824,4695484948545536,4650074292879360,6595003156004864,5600890109558784,5271131160838144,4818712207556608,6430553320980480,6208829929291776,6566059555946496,5669257533194240,5771860074037248,5759439062171648,6218154538172416,5864399556837376,4572044098797568,4572044098797568,4699677759373312,4752510186160128,4752510186160128,5461510552813568,5461510552813568,5742985529524224,5742985529524224,5639171958898688,5639171958898688,5824375294001152,4622145228374016,4622145228374016,6252051108462592,6252051108462592,4509041710596096,4509041710596096,6002685458251776,6002685458251776,6707150557544448,6707150557544448,5026585722748928,5026585722748928,5811100221177856,5811100221177856,6239153841766400,5265128290254848,5265128290254848,4623305557409792,4623305557409792,6466508036243456,6466508036243456,5858070084190208,5858070084190208,5756047733030912,5756047733030912,5405337900285952,5405337900285952,4957896847654912,4957896847654912,4875704142397440,4875704142397440,4587752438890496,5328033002029056,5328033002029056,5579456109346816,5579456109346816,6653850768375808,6653850768375808,6653739199889408,6653739199889408,4525398221127680,6023242446798848,6023242446798848,4543699278102528,4543699278102528,5086458657374208,5744284522250240,5744284522250240,6214678182100992,6214678182100992,6098838619160576,6098838619160576,5500644180885504,5500644180885504,6505829820792832,6505829820792832,6389092609687552,6389092609687552,6673891907862528,6673891907862528,6663618379644928,6663618379644928,4653522195841024,4653522195841024,4796145191616512,4796145191616512,5912802362392576,5912802362392576,6609699477651456,6609699477651456,6380447008292864,6380447008292864,4578892944769024,4578892944769024,6420132589993984,6420132589993984,5952668366274560,5195435600773120,5195435600773120,4843871069536256,4843871069536256,5123709697261568,5123709697261568,6706804611350528,6706804611350528,5869792811548672,5869792811548672,5980263782809600,5980263782809600,5342744607195136,5266388678606848,5266388678606848,4908386008170496,4908386008170496,5908181397012480,5176550948339712,5176550948339712,5503170359853056,5503170359853056,5866503118258176,6664718545584128,6664718545584128,6135037408837632,6135037408837632,4559828172144640,5160638295834624,5160638295834624,5517636011032576,5517636011032576,6110886958727168,6110886958727168,4600316929507328,4600316929507328,6624659620495360,5519568947642368,5519568947642368,4591194637074432,5795512090361856,5795512090361856,6112171439161344,6112171439161344,6070939837005824,6070939837005824,6113322607837184,6113322607837184,5666873709428736,4995286903554048,6047811639443456,6047811639443456,6515486417223680,6515486417223680,5401028320034816,5401028320034816,5566676635484160,5566676635484160,5532845379420160,5532845379420160,5838028592381952,5838028592381952,5610124893749248,6031998107254784,5386816709984256,5221889965817856,6318360756748288,5708153278169088,4921070456406016,5001489424056320,5858034751897600,5723932988014592,6371846018039808,6279718969540608,4646957087195136,6652565080506368,6377781662842880,4675780612718592,5641276375957504,5658868562001920,4744074887692288,5217985874100224,5895285036810240,4879482321633280,6363857378869248,5029295142993920,6031104854720512,5989091518185472,6130026575036416,5205526274637824,5543119294038016,5270440410349568,5971941713772544,5250876834316288,6403220854800384,5889903543451648,5629598494097408,5623027194134528,6157548759023616,4870093657341952,6486538958929920,5958773377597440,6416170214752256,6421710722564096,5899051890900992,6362268408741888,5145194936139776,5050709950595072,6314147595157504,5095978905894912,5940403836026880,6291392858423296,5946408267415552,5134977276051456,6218150848233472,5848714941300736,4873095973699584,4564270645248000,4564270645248000,6393050540015616,6321633823817728,5785072149463040,5041836648824832,6080029028515840,4989313493762048,6108049428709376,5495720236285952,5236235492130816,4743654282887168,6056501231222784,6156694228303872,5680983650598912,5598541753352192,4591479296622592,6661194005348352,6107942121635840,4602886796869632,6507296770752512,4896542300831744,4684366621442048,5078133518106624,5005763319169024,4686063133523968,6172602854277120,6181398947299328,5231798891577344,4885667477192704,4640540808708096,4670343586775040,4794008613683200,5982443311464448,5794482657689600,6449791587844096,5764800138706944,4677645131841536,4693369007112192,5727120390619136,6425477777981440,5422753238220800,5348050905595904,4928037463785472,5105316533895168,4787729472159744,5829018523271168,6418575799091200,5079452240838656,6080085131526144,6041623699390464,4670644368703488,6468375944888320,6595975161839616,5485580086935552,4764510912512000,6652380967337984,6535987353616384,6358158527692800,6142654248648704,5374306074230784,4538780316336128,5383205246468096,6381561804488704,4543285770584064,6154285053640704,4667436128796672,6371756461260800,5691193123405824,6086141136076800,6666683275542528,6699711574048768,4736250094813184,6482364754034688,6341627265679360,5555506516590592,6144844749078528,6369175185915904,5794190734131200,5529217021771776,5752490896654336,4614646685761536,5714188411863040,5428521547071488,4688859459223552,5560819424690176,5788538590724096,6650757570363392,4622184386920448,5018008572919808,6587050320461824,5121689116999680,4802882284552192,6679890367086592,6161041137860608,6686685005348864,5039676716482560,4660508413657088,6745182459920384,5880996385259520,5356623828090880,6552892479111168,4781647966240768,6409071271346176,6325615761817600,5330557738680320,4516983558635520,5746327752802304,6689717319368704,5766230631251968,6646973804838912,6076404579434496,4869308315860992,6593342548213760,4970463385616384,6716487850524672,5549961848029184,4714393140461568,5525927211040768,6327587151806464,4844418980380672,6194945710358528,4715119023489024,5291400555397120,6469041933254656,5494956235423744,5024365258735616,5110230244917248,4686248286879744,5379035101659136,5057977706348544,5006695796834304,6673675683627008,6552755174375424,4758352197844992,5732575334629376,5852460756762624,4886136064835584,6238827491885056,6177254840729600,5206467677782016,6176327127793664,6300769510227968,5945700268900352,4869965613629440,6510514271682560,4657953142996992,4986780134146048,6002784712785920,5761094018138112,5999838365220864,4590311703052288,6367122493538304,6604702904483840,5437064505458688,6481703664615424,6012530027134976,5174702166769664,6236916298547200,5286938252148736,6359022218772480,4887901430611968,4624456726609920,5817426842746880,5461266679726080,6752153527386112,6058370280194048,4908302592376832,5684622226096128,5262409761030144,6710861711802368,6691147811913728,6110725931532288,6735248536109056,6042577685446656,5556593545969664,5987761017847808,4848800115458048,6315694689353728,5570247280558080,6616990940135424,5209770675404800,6673435400339456,4713006168014848,5845511734558720,6010459953561600,5887314651250688,6188580837261312,6254809232965632,6187799153213440,5465428603699200,5860260652253184,6071620321411072,5693903717531648,5983195534721024,4902375604617216,5266425622560768,5273336258494464,4645605313347584,4916372936589312,5044195458285568,4700370441338880,4514681858818048,5821039111569408,5495660979159040,5823414228484096,5869679616196608,5688264492580864,6303991004135424,5928005272076288,6036921347735552,5069372590129152,5133144264540160,4974814590140416,6117374675124224,5338920442658816,5391907454189568,6377069872676864,4892819369492480,4751008172867584,5737300167753728,5812148562821120,5801303770398720,6428450599993344,5503782795870208,5055182051737600,5862305190903808,6499141466718208,6194886017024000,5140497315659776,5947727829008384,6721784014962688,6251575290363904,5465566210424832,4797247891439616,5938961867866112,4851690896883712,4917661594550272,4864966640795648,5870268160933888,5647672924438528,5924792804311040,6085987255451648,6435653427920896,5815906826977280,4548290179235840,5128832318701568,4575808034701312,4647302060310528,4837577701457920,6485853005676544,5224906509254656,5412935882506240,6419079216234496,4822626987409408,6009257731817472,4725028150575104,5398010871152640,4757304829804544,6710247934132224,6101139967180800,6334266497040384,5677033455091712,4683401361096704,5935775169904640,5139870485315584,6470279554924544,4893670075006976,4795895144513536,5555773643423744,5405303792730112,6568677289230336,6250029370572800,4558014119411712,4596505616318464,4756209680252928,6424207474294784,5315899753496576,6555242631528448,5059906817753088,6505820509962240,4725788494004224,6504892797026304,5987194619035648,6655697688723456,5104428515852288,6283135045599232,6716475770929152,4776937259532288,4682413619281920,5317931340136448,5675276914130944,5438911978930176,6725387828068352,5279560102313984,6403402719821824,6212182185869312,6095745656029184,6215618193260544,4949212726296576,5890841356271616,4628679316996096,5686714479149056,6566323781369856,6342083538845696,5246046539612160,6745840529440768,4528207180595200,6001582826586112,5018619431354368,5969885967941632,4828803351707648,5370871174135808,5459991745527808,5758388926939136,6637998229159936,6259023199862784,5317862721323008,5654558092558336,4537565947887616,5683411716407296,4873080236670976,4873080236670976,5981619885703168,6423683689611264,6550595678240768,5694265098764288,6492562080137216,6372882849988608,6610579225051136,6699145745661952,4576010267262976,5353425117642752,6255338218586112,5868310125608960,5327350404743168,5613433881362432,5474916891099136,5141820702457856,5186904974163968,4703119857942528,6582318373797888,6257039025635328,5805221350998016,5228016401121280,6483688744812544,5535991326048256,6635580330344448,5564754789138432,5373706053877760,5421135377727488,5813832827535360,6007570212323328,5224829602496512,5910924858228736,5145870957281280,6247804946612224,4602935551459328,6453697088847872,5725051592114176,5175463315505152,4929172710883328,5811002511196160,4577470723915776,5564832165658624,6752347673329664,6617326786445312,5216570447495168,4697600959184896,6550282346954752,6277659297841152,6023672111824896,4901096509669376,4742766835269632,6463618496856064,4826505812639744,6552829262561280,4822228025212928,5292930671050752,5795519154094080,4556580070096896,5055994572308480,4910957821689856,4997372597239808,4829061452398592,5754884602724352,5662637295140864,6257576164982784,5238483504857088,5271692191989760,5403753846407168,6424220896067584,5113684640137216,6077990697435136,5454425937674240,4724676667899904,6107127856234496,4782237819600896,6725311089082368,6599988238352384,6610077116530688,4749724917170176,5650375264174080,5509637775818752,6470619528429568,4507115133075456,5398011609350144,5125332725661696,6735017748725760,5534750483152896,4595789027868672,5265400199118848,5744817333600256,5621977007521792,5566245511888896,6410670442020864,5725760597262336,5052000487604224,4539293095165952,6094024011677696,6221623195074560,6592188678406144,5811698631442432,6122907666743296,5640359501103104,4874008486477824,5511725230587904,4625621937815552,6727888170123264,6566539167268864,6296785156308992,6651927412080640,6754181993463808,5438264177065984,5297526688710656,5415307576868864,4767849846931456,5768409723174912,5449748919615488,6515321715818496,5187154619138048,4791820126519296,5983690731028480,5771652490592256,6657863157547008,4509537695956992,4905361881956352,5748876279021568,4957227907022848,5267423330041856,4527520724025344,5113590486401024,4958752620412928,4786361256640512,6577465698287616,5276936716156928,6729520425467904,6261175716675584,5561916386181120,5663264729464832,4575847729594368,4947727472918528,5754820547313664,6380442663518208,5104021366374400,6139769909673984,4945833425895424,6716047146614784,6346791628308480,5088022613196800,4590115644506112,4923379336871936,6446293135654912,6114386720063488,5861357311754240,6525642757111808,4971276912820224,5481574862159872,5500300919570432,6708071493009408,5109613548011520,4596236107120640,6650123827806208,5679504168583168,6500929548845056,5339845269913600,5808280173019136,5144299703894016,5230181869944832,4889423459647488,5671330912927744,5968220527263744,5740935152926720,5581514556833792,4982315079434240,6032949979381760,6207145296527360,4914119622262784,5758544552394752,5565073455579136,5500232334311424,4519489437171712,5025264785948672,5929230847705088,5738006018785280,6687984065183744,4835641979830272,5631782921175040,6130961200185344,4549884954279936,6036424675033088,5027073000734720,5356088970444800,4639207389134848,4729367342612480,6362210829336576,5459614862147584,4950540978487296,5628969717596160,5724635819147264,6408957253386240,6589543515422720,5929029084905472,6447088040148992,4515843177709568,4586211921887232,5254714991575040,4982036107886592,5970574370668544,6256769516437504,4558165785444352,6745416535638016,5734011934081024,4941272640389120,5428399241166848,5936519642087424,6706504199045120,4853878645850112,4702287775137792,6565255643136000,4887521158234112,4964688835641344,4973484928663552,4857744183525376,5845105625268224,6332326715326464,5745226160799744,4870216768552960,5617884675440640,6049374269865984,6594736332210176,5180867458105344,5175631960080384,4640178387288064,6406144385351680,5454057510010880,6113807436349440,5996331490869248,6151452824698880,6459316080476160,5742644952563712,4712424032174080,6513505682849792,4543288253612032,5350901019049984,6542101642215424,5129242085425152,6182574224834560,6700585935437824,4687384439947264,4776492126437376,4589708293701632,4994345752592384,5426634210934784,5953399064887296,5708375475617792,6099801615106048,6416460963905536,6357349329010688,5461612491702272,5210344019984384,5210344019984384,6275959765860352,5282482324242432,5675016565293056,5863041643577344,4689991585759232,4752693813313536,6351727317483520,6352891253620736,5536233320611840,5630971709227008,6058741861974016,5249638742884352,5713684189413376,6197967588950016,4948922379796480,5204275365412864,4504032487407616,5795975829913600,6455820245532672,5472977109385216,4583480792449024,4617660142190592,6644068662116352,6312784983228416,6133710616788992,5601667248029696,5774784528384000,6261919719096320,6702918371115008,5629167957180416,5654482494423040,5036556959612928,5936326905430016,5941828758536192,5588967130398720,5465920612335616,6205999312011264,6291808463618048,5534249247047680,6748110084112384,5168330918330368,6275663681552384,5663287244488704,5472487650885632,5897491844694016,5640369332551680,4883905332641792,4690391286153216,6356228711645184,6120989091430400,6438833851203584,4589459588251648,6235514394378240,4897649261543424,6714042470629376,4532748840075264,5992900281761792,5783026704842752,6058106475249664,4885099367104512,5730744135057408,4814073560039424,5203300676272128,4721800482652160,5012071552385024,6155563645272064,5909573688360960,6157401924829184,5918223786049536,5733690516176896,5892183399333888,6380426691608576,6228754250072064,5942906996654080,4662031784869888,6051999165972480,6623745212416000,6738094421704704,6730500919525376,5553413592449024,6077966538244096,6572828375121920,5039039719145472,5182169571393536,5615398627573760,4735604675313664,4723595946754048,6242343627259904,5157271679533056,4553884609019904,6466021229068288,4569458160435200,4778623101304832,5264950838165504,6434083885809664,5114150308544512,5875124024115200,4852745714008064,5025454938914816,4584606610751488,5978868959150080,6453857982349312,5302707962773504,4564965725306880,6000223570100224,4953488500457472,4732864620396544,6185800517025792,4613735146061824,4825352479703040,6319640321458176,6607832627019776,6364849147215872,6731038058872832,5180748138545152,5035655553351680,6344199011565568,5382199351705600,5779453761814528,6719613512974336,5978942107811840,6595776720928768,5937250860269568,4559811932323840,5621944459722752,6606243589783552,6689806473494528,6032418779168768,5388530167054336,4595988475412480,5211714986967040,4705939638190080,6264136593309696,6409272128176128,5579196683780096,5933278082629632,5304439035920384,4546935653924864,5721407345917952,5389496568250368,5110242089631744,4838735732015104,6130666189619200,4998190687846400,4953179430584320,5813018998341632,6182648245911552,5878092114952192,5366127718301696,5756467231064064,4855129689292800,5312526526447616,6558548078624768,4867645257547776,4863169935179776,5043489842135040,4793922177466368,5163383854202880,6137555451379712,6730200808685568,4834775906385920,6517118891196416,5749780034093056,5031807531089920,4787844798742528,6303083490967552,6163479873978368,5773204785725440,5937036313231360,4708972019318784,6240669026222080,5990010439860224,4771751556284416,5859207210860544,6577098277781504,6577098277781504,4862891131928576,5709901733036032,5709901733036032,6308560279437312,6308560279437312,6598552209850368,6598552209850368,5696789533425664,5696789533425664,5463938401566720,5463938401566720,6323846823018496,6323846823018496,4979333164695552,5175390351917056,5175390351917056,5201886038720512,5538560186777600,5538560186777600,5129623532732416,4913535708561408,4913535708561408,5419444469760000,5124272892674048,5174266311999488,4893886870716416,4893886870716416,4822831015657472,4822831015657472,5239790920269824,5239790920269824,6275045861097472,6263828279459840,6263828279459840,6376378149109760,6376378149109760,5147923248054272,5147923248054272,5743957334556672,6506395734638592,6506395734638592,4508995591602176,5394639608086528,5397023918915584,5397023918915584,6249386770694144,4618562220589056,4618562220589056,6218871598481408,6218871598481408,5948606620631040,5948606620631040,5932144279420928,6033849944375296,5715016755445760,5742938522386432,5140848917872640,4594894200373248,6411433438347264,5485923971629056,5647943408812032,5260198207291392,5147184732831744,6583288652627968,6583288652627968,4518319983427584,5029356834914304,5029356834914304,5831188607926272,6284513883193344,5682273568948224,5682273568948224,4688611443736576,4594302937726976,5811080107917312,4858577224728576,4590958080950272,5257726034182144,6642183072907264,6642183072907264,5871803446067200,5722115312975872,5722115312975872,4614598050709504,5460930013429760,5011672189632512,5011672189632512,6389317527666688,4978532456857600,4618335041355776,4683051709235200,4571936744538112,6305458778275840,6305458778275840,5775078400720896,5713754991886336,4572703044403200,5406918971490304,5619674706345984,5348430509506560,5694106841907200,6308304647094272,6308304647094272,6394981549867008,6394981549867008,5097622337486848,5097622337486848,5310365237772288,5104013634699264,5391939903946752,6165322149134336,6165322149134336,6001559861723136,6151961177489408,6151961177489408,4923390077435904,4707851488985088,6606209904279552,5502819921035264,5502819921035264,4963724400525312,6620555313152000,5080289846493184,6410784949665792,4969634594291712,4969634594291712,5096014057308160,5096014057308160,5096014057308160,5569530158383104,6601967332229120,6601967332229120,5856919372169216,5856919372169216,4595109536989184,4595109536989184,4716171864047616,4716171864047616,5038350296154112,5038350296154112,5315345772969984,5315345772969984,4786540859883520,5893817922748416,5280277616656384,5318043264090112,5418979357622272,5418979357622272,6592424552431616,5000640986611712,5000640986611712,5313426392350720,5313426392350720,4952451638099968,5670037627600896,4628456669708288,4628456669708288,5587127864131584,6227134027137024,6227134027137024,5561706204364800,5561706204364800,5847729568219136,6646563554721792,6646563554721792,6145761845182464,6145761845182464,5961134119583744,4820292055072768,6217870285996032,5854408712126464,5656380806004736,4763701951856640,4763701951856640,5032592758276096,5358391948476416,5358391948476416,5194173907468288,5194173907468288,6719016180121600,5436242609569792,4697151785926656,5153161415753728,5153161415753728,5370306405859328,4671042948169728,5203447362617344,5203447362617344,6133810293374976,6133810293374976,4962121942040576,4962121942040576,4882807116529664,4882807116529664,5778990764654592,6272697255329792,6272697255329792,5215207654686720,5215207654686720,6000448069697536,6000448069697536,5250456853938176,5250456853938176,6071817809690624,6071817809690624,4731028206780416,4731028206780416,5490112270958592,5490112270958592,4743346709856256,4743346709856256,5051901455368192,5051901455368192,5399437391167488,5399437391167488,6694018061697024,5670583223189504,5670583223189504,5737756595585024,5737756595585024,6070968748343296,6070968748343296,4571608617320448,4571608617320448,5364717328531456,5364717328531456,4991544816828416,4991544816828416,5644715323031552,5644715323031552,5874917114380288,5874917114380288,6454595998973952,6454595998973952,4881031868973056,4881031868973056,5433034168860672,4944623607742464,4944623607742464,6051097411059712,6051097411059712,5086632507080704,5047222054944768,6475831357472768,6475831357472768,4764505950126080,4764505950126080,6377442313764864,6377442313764864,4854846342561792,4854846342561792,5115980354158592,5115980354158592,6607085642448896,6607085642448896,6384202693476352,5101364698415104,5101364698415104,6247107354165248,5771753275523072,6365777317330944,4689022084972544,6679146737958912,6555717984583680,6722770771116032,4720220861628416,6198973806673920,5071841277771776,4749821809786880,5368013649346560,5231674224279552,6407567550447616,6687268722442240,6601854707826688,6516664031510528,5660711425933312,6023661949026304,5546422379741184,6307494879559680,6295718112788480,5521661926834176,6143538848333824,5329552368205824,5829649786994688,6491757667155968,4538067238518784,6593131780243456,5819015481524224,4830262487154688,4992191344148480,5027375716237312,5884518044532736,6348537738035200,4757080589729792,4833835967053824,4622519381786624,6121819450376192,6379869709008896,4897693691805696,5101949468278784,5669220175577088,4948954176815104,6220419115253760,6124263387430912,4795091301957632,4608689738088448,4984903136968704,5545048493522944,5965169309515776,5865453087358976,4538694790283264,5684656506142720,5718913165295616,5708858663632896,5560476150267904,5190864183230464,6200237332365312,5166361394806784,6486754617458688,5970675675693056,5572673941274624,5305552745267200,4998849130659840,6341580461441024,6638504435515392,5887241708109824,6427793423859712,6029890473689088,5672643683942400,5209762173550592,5667674440335360,5452273240506368,5327409984831488,4896856693276672,5008448567115776,6211550561435648,4628777887334400,6433080763482112,4582710101671936,5273542739886080,6234030571257856,5143186204262400,5618806604431360,5225744082403328,6593704051081216,6468445641637888,6054200340905984,6125921999781888,5808334938046464,5319344321462272,4907091885555712,6065646445527040,6444445465051136,6411808008568832,4690140303196160,6563811212918784,5271468539117568,5440308048822272,5268238790819840,5116102476038144,5712024910168064,5769452917882880,6480867005825024,5115406708113408,5225473851785216,6073467950071808,6573865999794176,6371031891050496,4845884759605248,6386313435021312,4516194480029696,5177890060107776,5890734372159488,4797862780600320,6223929361825792,6467707427356672,5431181494976512,5785932942278656,4521997081509888,5500029887840256,4622130032934912,6476254580047872,5013904115105792,5963761935974400,5225534367203328,5950812626354176,5217842114330624,5269639419920384,5533702599213056,6281589566210048,5712562250842112,6485892604100608,4641925721751552,5571829107785728,6061463969464320,6138515699531776,6138515699531776,6241964348932096,5624021701361664,6729039477211136,5852144611098624,6473656460378112,4524492977602560,5804646634881024,5854472584036352,6292288665288704,4649055669452800,4736462750220288,6277565752279040,6627571227164672,4969877076443136,6111698427052032,6163491437674496,5589670938804224,4677991132561408,5496564671315968,6024343204659200,4913961048211456,6699786991828992,5143157699772416,6070054591922176,6365728764067840,6483097368920064,5206839246979072,6230600536555520,6105415191887872,6220812389974016,4664651266129920,5884761297387520,5157623334174720,4809413172396032,6503434173284352,6239860653817856,6094166773202944,6353814726115328,5354805366620160,4934937953697792,5416360871460864,5648336383639552,5641842393088000,5721363712573440,5212221126213632,6581899098587136,5575068570091520,4559862872145920,5260543853592576,4852753888706560,6361528655151104,4915932907962368,6525205614166016,6437897552527360,5729038970126336,6671719867088896,6330162626428928,5452022203023360,4775796798914560,6195575581573120,6349721991380992,5015400223342592,6708648130117632,5191790251999232,4726855780794368,6416362771054592,4985769344630784,6262834937200640,6587487236915200,5193100351242240,5897487889465344,5397596662661120,6510332494741504,5497987228237824,4639745388314624,6405891808559104,5620479762628608,5620479762628608,5132610166063104,4894402689892352,4814855617380352,5476688619634688,6028725061156864,5843886848606208,5989713940316160,6195928221876224,5437587321257984,5796053881716736,5442041202343936,6521246241521664,4851388726640640,6627812986847232,5478973676453888,5533592775557120,6202147384852480,6576977787486208,6576977787486208,4661920589676544,5997294658256896,6296361821011968,5268013539917824,6236867967582208,5400414496751616,6053575943258112,5979792716857344,6551397046157312,6297551594061824,5118621860757504,5118621860757504,5872776728543232,6181259852120064,4858277384945664,4544839983562752,4544839983562752,5955032415993856,4725915888648192,5587087382806528,5587087382806528,4682709037744128,6552034463973376,6552034463973376,5563139752460288,5563139752460288,4973874702188544,4973874702188544,4720969965371392,4720969965371392,5318962573737984,5989437100523520,5989437100523520,5176189388324864,5176189388324864,4559282314412032,5184196364992512,5964828347203584,6589458359517184,5772925215440896,5772925215440896,6197482866868224,6197482866868224,4951478830628864,4773276527099904,4773276527099904,5459406209679360,5459406209679360,6077439135449088,6077439135449088,6719553926070272,6719553926070272,5197159818330112,6009243711832064,6009243711832064,4922247719419904,5860801219919872,6029919885721600,5704889712771072,5264359396737024,5378695737901056,5373872623845376,5373872623845376,6668294162481152,6668294162481152,6490276357996544,6490276357996544,6430971466350592,6430971466350592,5034016223789056,5034016223789056,4684015077425152,6460216016109568,6460216016109568,6717136731897856,5236356562288640,6741673880059904,6741673880059904,6033631442108416,6273136015179776,6273136015179776,5509349179916288,5509349179916288,4657854834278400,4657854834278400,6520053987016704,6260199926005760,5202469740085248,6181687990943744,6181687990943744,5941264311648256,5410548104560640,5410548104560640,5469402074972160,5469402074972160,5264261602344960,6560079022129152,6505240963579904,6564086344056832,5225680045342720,5225680045342720,6295938701197312,5237809083318272,4801371720122368,4801371720122368,5166882161164288,5420706155200512,5420706155200512,6228215841423360,6096274446090240,6096274446090240,4507707810775040,5808211039879168,4583638638264320,6592128806289408,5252605883187200,6109576429568000,6109576429568000,4765543790804992,6594547023872000,5188649659400192,5188649659400192,5478654457937920,6471148452708352,5983489275985920,5763028806008832,5763028806008832,6116182491922432,6116182491922432,5548495340568576,5548495340568576,5075529297297408,5647773593501696,4574010328219648,4574010328219648,5084505862832128,5488413210836992,5488413210836992,5890100060749824,5274429501210624,5274429501210624,4748003949674496,5278337921449984,5278337921449984,5508196115415040,5508196115415040,5766495633145856,4791542368698368,5048377151586304,4806763850235904,6280526076837888,6280526076837888,4890910966939648,4890910966939648,5146392868683776,5146392868683776,4840041474949120,5643050606395392,4612477582573568,5133452820611072,4594868417986560,4746953344155648,5323217880743936,4896813745700864,5184353350451200,5333616499884032,5729565474816000,5857233411244032,5368023835213824,6144098672574464,5898156346179584,4848118933225472,6638360438767616,6264797118595072,5431328700366848,4920235175968768,4920235175968768,5741622975266816,4527295111364608,5401127783235584,5401127783235584,6598384595501056,4555715346169856,5646667339005952,5646667339005952,5200514743009280,5830801378246656,6467384284545024,4666002019713024,6413838977597440,4767878845300736,6102638985216000,6698772292173824,6698772292173824,6423808888537088,6627377520574464,5409294931984384,4917010125815808,4917010125815808,5002694773702656,5002694773702656,4638807964516352,5711321864077312,5577851477164032,4549520375939072,4549520375939072,5843997765926912,4780315057324032,5433004443303936,4916873978707968,6331524570415104,4593922822111232,6589261582172160,6589261582172160,5169521521328128,6168011256889344,6168011256889344,5137240681349120,4597178642202624,4597178642202624,6285375667437568,4874251310989312,6085411116941312,6085411116941312,5316745148497920,5316745148497920,6276296727330816,6276296727330816,4512091716190208,4512091716190208,5726734254080000,5726734254080000,4973633247117312,4973633247117312,5522027623481344,4799644222619648,6609938678808576,6609938678808576,4525836131631104,4525836131631104,5096809100738560,5096809100738560,6613117374038016,6613117374038016,5133982294343680,5133982294343680,5134712573001728,5134712573001728,5074007572348928,5074007572348928,5340501719908352,6244274625576960,6244274625576960,4504555172659200,4504555172659200,6646111782567936,6646111782567936,5001448579399680,5632916162871296,5632916162871296,5715057412407296,5715057412407296,5743279726395392,5743279726395392,5222669577355264,5222669577355264,5852445010821120,5852445010821120,6528060596682752,5779460715446272,5779460715446272,6307149071253504,6307149071253504,5805088902742016,5805088902742016,6671461132533760,6671461132533760,5471301257920512,5452257591033856,5452257591033856,4872840732999680,5120973996032000,5120973996032000,6683088196206592,6448587310366720,6448587310366720,6448587310366720,4785322620616704,5288907569627136,5288907569627136,4978866916425728,4978866916425728,6540869262901248,6540869262901248,5244944502489088,5244944502489088,6262641315020800,6085538439233536,6085538439233536,6241166679867392,5712228639571968,6242214903545856,6242214903545856,5250047443730432,5250047443730432,6559819312922624,6559819312922624,6034347244126208,6034347244126208,6168083986120704,6168083986120704,5563125058240512,5563125058240512,5852021755215872,5852021755215872,5173979596718080]
def users = [1111111111111111]
def usrs = users as HashSet<Long>

def count = 0

def s = { Entity it ->
    if (usrs.contains(it.key.id)) {
        count++
    }
    usrs.contains(it.key.id)
}

def u = { Entity it ->
    it.setProperty('forceNotSocial', true)
    it
}

def res = new DatastoreUtil('User').setShouldUpdate(s).setUpdateEntity(u).execute()

//usrs.each { Long it ->
//    Filter f = new FilterPredicate('userId', FilterOperator.EQUAL, it)
//    Query q = new Query('UserPushData').setFilter(f)
//    def keys = []
//
//    def pushS = { Entity that ->
//        if ('browser'.equals(that.getProperty('platform'))) {
//            keys << that.key
//        }
//        false
//    }
//
//    def r = new DatastoreUtil(q).setShouldUpdate(pushS).setUpdateEntity(null).execute()
//
//    DatastoreServiceFactory.getDatastoreService().delete(keys)
//}

MemcacheServiceFactory.getMemcacheService().delete('level_TOP_PLAYERS_MC_KEY')
MemcacheServiceFactory.getMemcacheService('default').delete('level_TOP_PLAYERS_MC_KEY')

'OK ' + res + ', found ' + count